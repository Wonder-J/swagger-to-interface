"use strict";exports.__esModule=!0,exports.getInterfaceDocs=exports.getTypeJudgeStr=void 0;var axios_1=require("axios"),fs=require("fs"),service_1=require("./service"),getTypeJudgeStr=function(e,r){var t,i;if("integer"===e.type)return"number";if("string"===e.type)return e.enum?"'"+(null===(t=e.enum)||void 0===t?void 0:t.join("'|'"))+"'":"string";if("array"===e.type){if("integer"===e.items.type)return"number[]";if("number"===e.items.type)return"number[]";if("string"===e.items.type)return e.items.enum?"('"+(null===(t=e.enum)||void 0===t?void 0:t.join("'|'"))+"')[]":"string[]";if(e.items.originalRef)return(null===(i=e.items.originalRef)||void 0===i?void 0:i.replace(/(«|»|,)/g,""))+"[]"}else if(null!=e&&e.originalRef)return null===(i=null==e?void 0:e.originalRef)||void 0===i?void 0:i.replace(/(«|»|,)/g,"");return e.type};exports.getTypeJudgeStr=getTypeJudgeStr;var getInterfaceDocs=function(e){axios_1.default.get(e).then(function(e){var n=e.data.definitions,r=e.data.paths;(0,service_1.default)(r,n);var e=fs.createWriteStream("./interface/api.d.ts"),r=Object.keys(n),o="declare namespace API {\n";r.forEach(function(e){var r,t=null===(r=n[e])||void 0===r?void 0:r.properties,i=null===(r=n[e])||void 0===r?void 0:r.required;t?(o+="interface "+(null==e?void 0:e.replace(/(«|»|,)/g,""))+" {\n",Object.keys(t).forEach(function(e){o+="\t"+e+(null!=i&&i.includes(e)?"":"?")+": "+(0,exports.getTypeJudgeStr)(t[e],n)+";\n"}),o+="}\n"):o+="type "+(null==e?void 0:e.replace(/(«|»|,)/g,""))+" = "+n[e].type+" \n"}),o+="}\n",e.write(o,"utf-8"),e.on("finish",function(){console.log("写完了")}),e.on("error",function(e){console.log(e)})})};exports.getInterfaceDocs=getInterfaceDocs;